<!doctype html>

<html lang="en">

<head>
  <title>Western Watersheds</title>

  <!--Requried meta tags-->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
  <!-- Animate CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya+Sans+SC|Roboto" rel="stylesheet">>
  <!-- Storymap CSS -->
  <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">

  <!-- Add favicon for the web page -->
  <!--<link rel="icon" href="/images/favicon.ico" type="image/x-icon">-->

  <style>
    .feature-label {
      font-family: 'Roboto', sans-serif;
      color: black;
      font-size: 12px;
      font-weight: bold;
      text-shadow: 0 0 3pm #ffffff;
      background-color: rgba(0, 0, 0, 0);
      border: none;
      box-shadow: none;
    }

    .feature-tooltip {
      font-family: 'Roboto', sans-serif;
      color: black;
      font-size: 14px;
      font-weight: lighter;
    }

    .glyphicon-one-fine-smaller-dot:before {
      content: "\25cf";
      font-size: 1em;
    }

    .glow-effect {
      color: rgba(0, 255, 0, .6);
      text-shadow: 0 0 10pm rgb(0, 255, 0);
    }
  </style>

</head>

<body>

  <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark storymap-navbar">
    <a class="navbar-brand navbar-custom" href="#">
      <!--convert the style value to a class and then add the class to the css file.-->
      <!--<img src="img/logo.png" class="d-inline-block align-top">-->
      Water Reclamation Projects & Biodiversity
    </a>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse">
      <!--Create class ml-auto for the navbar items you want on the right.-->
      <ul class="navbar-nav ml-auto"></ul>
    </div>
  </nav>

  <div class="container">
    <h1>Water Reclamation Projects & Biodiversity</h1>
    <h2>in Western Watersheds</h2>
  </div>

  <div id="storymap" class="container-fluid">
    <div class="row">
      <div class="col-sm-6 col-md-4 storymap-story">
        <section data-scene="scene1">
          <h2>Organizing Water</h2>
          <p>How you develop an organizational structure for water? A watershed is an area of land in which all streams
            and precipitation drain into a common outlet. It
            includes all surface and underlying groundwater. Boundaries follow the highest ridgeline around the stream
            drainage area and converge at the lowest point where water flows out of the watershed.</p>
          <p>Watersheds exist on several scales. are organized into nested hydrologic units (HUC).</p>
          <li>22 regional watersheds (HUC2)</li>
          <li>223 sub-regions (HUC4)</li>
          <li>387 basins (HUC6)</li>
          <li>2,318 sub-basins (HUC8)</li>
          <br>
          <p>By the late eighties, the emergence of GIS permitted federal agencies to further divide
            the sub-basins into watersheds that could be used to examine trends and patterns on more local levels.</p>
          <li>18,586 watersheds (HUC10)</li>
          <li>101,534 sub-watersheds (HUC12)</li>
          <br><i>Source:<a
              href="https://www.nrcs.usda.gov/wps/portal/nrcs/detail/national/water/watersheds/dataset/?cid=nrcs143_021617"
              target="_blank"> USDA Natural Resources Conservation Services</a></i>
          </p>
        </section>
        <section data-scene="scene2">
          <h2>...in the West</h2>
          <p>The American West presented unique water management challenges due to inadequate precipitation for
            agriculture. Initially, settlers diverted water from streams, but as demand outweighed supply, settlers
            pressured the federal government to undertake water storage and irrigation projects.</p>
          <p>Water management found its first home at the US Geological Survey, but was moved to an independent bureau
            within the
            Department of the Interior by 1907. By 1923, the agency was known as the Bureau of Reclamation and by 1928,
            federal funds began flowing through the USBR for major projects like the Hoover Dam.
            <br><i>Source:<a href="https://www.usbr.gov/history/borhist.html" target="_blank"> USBR History</a></i></p>
        </section>
        <section data-scene="scene3">
          <h2>Everyone is in charge</h2>
          <p>Watersheds form the best hydrological planning units for land, water, and ecosystem management....and yet,
            in the United States, one watershed can be controlled by multiple state, county, and city agencies with
            conflicting interests and needs. One connected stream can be subject to multiple water quality regulations,
            stormwater ordinances, fishing licenses regulations based on government offices.
            <br>Successful watershed management requires a substantial amount of interagency coordination. The
            subcommittee on Spatial Water Data alone includes members from the Natural Resources Conservation
            Service, USGS, Forest Service, BLM, Corps of Engineers, EPA, FEMA, NOAA, NWS.
            <br><i>Source:<a href="https://aquadoc.typepad.com/files/watershed-usa.pdf" target="_blank"> What if... the
                United States of American were based on Watersheds?</a></i>
          </p>
        </section>
        <section data-scene="scene4">
          <h2>Health & Species at Risk</h2>
          <p>All land drains into a lake, river, stream or other water body and directly affects its quality. The EPA
            tracks watershed health based on six ecological attributes:
            <li>Landscape Condition</li>
            <li>Habitat</li>
            <li>Hydrology</li>
            <li>Water Quality</li>
            <li>Biological Condition</li>
            <br>When watersheds are not healthy, wildlife suffers. Pollutants introduced to the ecosystem alter
            habitats. This reduced biodiversity by eliminating some species and introducing new, invasive ones that
            destroy native species. This, in turn, can affect the food chain. Freshwater ecosystems are tighly linked to
            watersheds and they are greatly influenced by human uses or mofications of land as well as water.
            Unfortunately, healthy watersheds are uncommon in parts of the nation hat are urbanized, farmed, or mined.
            <br><i>Source: <a href="https://www.epa.gov/hwp" target="_blank">EPA Healthy Watersheds Program</a></i>
          </p>
        </section>
        <section data-scene="scene5">
          <h2>Supplying water to arid areas</h2>
          <p>The Bureau of Reclamation is best known for dams, powerplants, and canals that facilitated the economic
            developement of the West. Today, the USBR is the largest wholesaler of water in the US. 10 million acres of
            farmland are irrigated by reclamation water. One out of ever five farmers in the American West are served by
            reclamation water. 25% of the nation's fruti and nut crop and 60% of the nation's vegetables are produced
            using reclamation water. The USBR is responsible for 338 reservoirs, 492 dams, and 8,116 miles of irrigation
            canals.
            <br><i>Source:<a href="https://www.usbr.gov/main/about/fact.html" target="_blank"> USBR Fact Sheet</a></i>
          </p>
        </section>
        <section data-scene="scene6">
          <h2>Case Study: Solano Project</h2>
          <p><i>In 1948, the federal government had to choose between saving Berryessa Valley for farming or flooding it
              to benefit neighboring Solano. Napa County touted the valley’s 12,000 acres as some of the most fertile in
              California. But in the eyes of the dam builders, the U.S. Bureau of Reclamation, Devil’s Gate was one of
              the best dam sites in the entire Central Valley.<br>--Peter Jensen</i>

            <br>And in the winter of 1957, the 300-foot-high Monticello Dam was complete at Devil’s Gate. Napa County
            lost one-eighth of its farmland. The decision to flood Berryessa Valley reflected California’s insatiable
            need
            for water, its most precious resource.
            <br><i>Source:<a
                href="https://napavalleyregister.com/news/local/the-year-they-flooded-an-agrarian-paradise/article_63b286fe-e825-11e1-9d12-001a4bcf887a.html"
                target="_blank">Napa Register, August 10, 2012</a></i>
          </p>
        </section>
        <section data-scene="scene7">
          <h2>Solano Project: Ecological Impact</h2>
          <p>Ecological Impact
            Forest change, N-Index, NEF, Habitat condition index, PHWA WS Health Index, At Risk Counts, % Rare ecosystem
          </p>
        </section>
        <section data-scene="scene8">
          <h2>Solano Project: Stressors</h2>
          <p>% Urban, % urban change, % agriculture, % agriculture change, count of mining, density of roads, count of
            road/stream corssings, % ag and urban contiguous to water, empower density, PHWS WS Vulnerability Index,
            Population, Pop density, count of dams</p>
        </section>
        <section data-scene="scene9">
          <h2>Solano Project: Social Impact</h2>
          <p>GAP Status.</p>
        </section>
        <section data-scene="scene10">
          <h2>Resources</h2>
          <p>Brief Conclusion and list of hyperlinks to EPA, USBR, USGS, etc. here.</p>
        </section>
      </div>
      <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>
  </div>

  <!-- Add libraries -->
  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.4.0.min.js"
    integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin="anonymous"></script>
  <!-- Popper.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
  </script>
  <!-- Boostrap -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
  </script>
  <!-- Leaflet.ajax for asynchronously adding geojson data -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
  <!-- Chroma Lib -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.0.3/chroma.min.js"></script>
  <!-- Storymap Plugin-->
  <script src="js/storymap.2.4.js"></script>
  <!-- d3 -->
  <script src="https://d3js.org/d3.v5.js"></script>

  <script type="text/javascript">
    // Load data using d3, promise //

    var nationalwatersheds = d3.json('./data/us-huc2.geojson');
    var watershedshuc2 = d3.json('./data/watersheds-huc2.geojson');
    var watershedshuc4 = d3.json('./data/watersheds-huc4.geojson');
    var epahuc8 = d3.json('./data/epa-huc8.geojson');
    var usbr = d3.json('./data/usbrpoints.geojson');
    var hydroline = d3.json('./data/hydroline.geojson');
    var waterbody = d3.json('./data/waterbody.geojson');
    var station = d3.json('./data/station.geojson');
    var casestudy = d3.json('./data/case_study.geojson');

    Promise.all([nationalwatersheds, watershedshuc2, watershedshuc4, epahuc8, usbr, hydroline, waterbody, station,
      casestudy
    ]).then(ready);

    function ready(data) {

      var nationalwatershedsdata = data[0];
      var watershedshuc2data = data[1];
      var watershedshuc4data = data[2];
      var epahuc8data = data[3];
      var usbrdata = data[4];
      var hydrolinedata = data[5];
      var waterbodydata = data[6];
      var stationdata = data[7];
      var casestudydata = data[8];

      /// Scene One ///
      var national_legend = '<i style="background: black; opacity: 0.5"></i><p><b>HUC2</b></p>';
      var national = L.geoJson(nationalwatershedsdata, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: .75,
            fillOpacity: .25,
            fillColor: '#2888ce'
          };
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.NAME + "<br>" + "HUC2: " +
            feature.properties.HUC2, {
              sticky: true,
              className: "feature-tooltip"
            });
          layer.on('mouseover', function () {
            layer.setStyle({
              weight: 2,
              fillOpacity: .7
            })
            layer.on('mouseout', function () {
              layer.setStyle({
                weight: 1,
                fillOpacity: .25
              })
            })
          })
        }
      });

      /// Scene Two ///
      var huc2_legend = '<i style="background: black; opacity: 0.5"></i><p><b>HUC2</b></p>';
      var huc2 = L.geoJson(watershedshuc2data, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: .75,
            fillOpacity: .25,
            fillColor: '#2888ce'
          };
        }
      });
      var huc4_legend = '<i style="background: black; opacity: 0.5"></i><p><b>Sub-Region: HUC4</b></p>';
      var huc4 = L.geoJson(watershedshuc4data, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: .5,
            fillOpacity: .2,
            fillColor: '#1f78b4'
          };
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.Name + "<br>" + "HUC4: " +
            feature.properties.HUC4, {
              sticky: true,
              className: "feature-tooltip"
            });
          layer.on('mouseover', function () {
            layer.setStyle({
              weight: 2,
              fillOpacity: .6
            })
            layer.on('mouseout', function () {
              layer.setStyle({
                weight: 1,
                fillOpacity: .25
              })
            })
          })
        }
      });

      /// Scene Three ///
      var huc8_legend = '<i style="background: black; opacity: 0.5"></i><p><b>HUC8</b></p>';
      var huc8 = L.geoJson(epahuc8data, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: .25,
            fillOpacity: .3,
            fillColor: '#1f78b4'
          };
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.Name + "<br>" + "HUC8: " +
            feature.properties.HUC8 + "<br>" + " Habitat Condition Index: " + feature.properties
            .wsioHabitatConditionIndex, {
              sticky: true,
              className: "feature-tooltip"
            });
          layer.on('mouseover', function () {
            layer.setStyle({
              weight: 1,
              fillOpacity: .6
            })
            layer.on('mouseout', function () {
              layer.setStyle({
                weight: .25,
                fillOpacity: .3
              })
            })
          })
        }
      });

      /// Scene Four ///
      // Style Choropleth Map
      function setColor(total) {
        // Tenary operation: condition ? valueIfTrue : valueIfFalse
        return total > 29 ? '#b30000' :
          total > 17 ? '#e34a33' :
          total > 9 ? '#fc8d59' :
          total > 4 ? '#fdcc8a' :
          '#fef0d9';
      }
      // Set style function that sets fill color property
      function style(feature) {
        return {
          fillColor: setColor(feature.properties.total),
          fillOpacity: 0.5,
          weight: .5,
          opacity: .8,
          color: '#ffffff',
        };
      }
      var epa_choropleth = L.geoJson(epahuc8data, {
        style: style,
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.Name + "<br> " + "Total At Risk Species: " + feature.properties
            .total, {
              className: 'feature-tooltip',
              permanent: false,
              direction: 'right'
            });
          layer.on('mouseover', function () {
            layer.setStyle({
              weight: 1,
              fillOpacity: .8
            })
            layer.on('mouseout', function () {
              layer.setStyle({
                weight: .5,
                fillOpacity: .5
              })
            })
          })
        },
      });
      var epa_choropleth_legend = '<p><b># of At Risk Species</b></p>' +
        '<i style="background: #fef0d9; opacity: 0.5"></i><p><b>0 - 4</b></p>' +
        '<i style="background: #fdcc8a; opacity: 0.5"></i><p><b>5 - 9</b></p>' +
        '<i style="background: #fc8d59; opacity: 0.5"></i><p><b>10 - 17</b></p>' +
        '<i style="background: #e34a33; opacity: 0.5"></i><p><b>18 - 29</b></p>' +
        '<i style="background: #b30000; opacity: 0.5"></i><p><b>30 - 49</b></p>';

      /// Scene Five ///
      var usbr_legend = '<i style="background: black; opacity: 0.5"></i><p><b>USBR Water Reclamation Projects</b></p>';
      var usbr = L.geoJson(usbrdata, {
        pointToLayer: function (feature, latlng) {
          return L.circle(latlng, {
            radius: 20000,
            fillColor: '#ffffff',
            fillOpacity: 0.5,
            stroke: true,
            weight: 1.5,
            opacity: 0.8,
            color: '#ffffff',
          });
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.description + "<br>" + "Type: " +
            feature.properties.type, {
              sticky: true,
              className: "feature-tooltip"
            });
        }
      });

      /// Scene Six ///
      var case_study_6_legend =
        '<i style="background: black; opacity: 0.5"></i><p><b>Lake Berryessa & Monticello Dam</b></p>';
      var case_study_6 = L.geoJson(stationdata, {
        pointToLayer: function (feature, latlng) {
          return L.circle(latlng, {
            radius: 1000,
            fillColor: '#FFD700',
            fillOpacity: 0.2,
            stroke: true,
            weight: 1,
            opacity: 0.8,
            color: '#ffffff',
          });
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.Station + "<br>" + "Agency: " +
            feature.properties.Agency, {
              sticky: true,
              className: "feature-tooltip"
            });
        }
      });

      var hydro_legend = '<i style="background: black; opacity: 0.5"></i><p><b>Water</b></p>';
      var hydro = L.geoJson(waterbodydata, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: 1,
            fillOpacity: .75,
            fillColor: '#2888ce'
          };
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.Name + "<br>" + "Type: " +
            feature.properties.Feature, {
              sticky: true,
              className: "feature-tooltip"
            });
        }
      });
      var hydro2_legend = '<i style="background: black; opacity: 0.5"></i><p><b>Water</b></p>';
      var hydro2 = L.geoJson(hydrolinedata, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: 1,
            fillOpacity: .75,
            fillColor: '#2888ce'
          };
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.Name + "<br>" + "Type: " +
            feature.properties.Feature, {
              sticky: true,
              className: "feature-tooltip"
            });
        }
      });
      /// Scene Seven ///
      function setColor7(HabitatConditionIndexWS2015) {
        // Tenary operation: condition ? valueIfTrue : valueIfFalse
        return HabitatConditionIndexWS2015 > 4.77 ? '#006837' :
          HabitatConditionIndexWS2015 > 4.51 ? '#31a354' :
          HabitatConditionIndexWS2015 > 4.12 ? '#78c679' :
          HabitatConditionIndexWS2015 > 3.42 ? '#c2e699' :
          '#ffffee';
      }
      // Set style function that sets fill color property
      function style7(feature) {
        return {
          fillColor: setColor7(feature.properties.HabitatConditionIndexWS2015),
          fillOpacity: 0.5,
          weight: .5,
          opacity: 0.8,
          color: '#ffffff',
        };
      }
      var case_study_7 = L.geoJson(casestudydata, {
        style: style7,
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.SUBWTRSHED + "<br>" + "Region: " + feature.properties
            .NameHUC8Watershed + "<br>" + "Habitat Condition Index: " + feature.properties
            .HabitatConditionIndexWS2015 + "<br>" +
            "At Risk Aquatic Species: " + feature.properties.CountofAquaticSpecies + "<br>" +
            "At Risk Wetlands Species: " + feature.properties.CountofWetlandsSpecies + "<br>" +
            "At Risk Terrestrial Species: " + feature.properties.CountofTerrestrialSpecies, {
              className: 'feature-tooltip',
              permanent: false,
              direction: 'right'
            });
        }
      });
      var case_study_legend_7 = '<p><b>Habitat Condition Index</b></p>' +
        '<i style="background: #ffffee; opacity: 0.5"></i><p><b>2.25 - 3.42</b></p>' +
        '<i style="background: #c2e699; opacity: 0.5"></i><p><b>3.43 - 4.12</b></p>' +
        '<i style="background: #78c679; opacity: 0.5"></i><p><b>4.13 - 4.51</b></p>' +
        '<i style="background: #31a354; opacity: 0.5"></i><p><b>4.52 - 4.77</b></p>' +
        '<i style="background: #006837; opacity: 0.5"></i><p><b>4.78 - 5.00</b></p>';

      /// Scene Eight///
      // style choropleth case study map
      function setColor8(Stressor) {
        // Tenary operation: condition ? valueIfTrue : valueIfFalse
        return Stressor > .29 ? '#bd0026' :
          Stressor > .2 ? '#f03b20' :
          Stressor > .14 ? '#fd8d3c' :
          Stressor > .09 ? '#fecc5c' :
          '#ffffb2';
      }
      // Set style function that sets fill color property
      function style8(feature) {
        return {
          fillColor: setColor8(feature.properties.Stressor),
          fillOpacity: 0.5,
          weight: .5,
          opacity: 0.8,
          color: '#ffffff',
        };
      }
      var case_study_8 = L.geoJson(casestudydata, {
        style: style8,
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.SUBWTRSHED + "<br>" + "Stressors Index: " + feature.properties
            .Stressor + "<br>" + "Population:" + feature.properties.PopulationinWS + "<br>" +
            "Count of Road-Stream Crossings: " + feature.properties.CountroadstreamCrossings2015 + "<br>" +
            "% Agriculture Next to Water: " + feature.properties.AgricultureContiguoustoWaterinWS2011 + "<br>" +
            "% Urban Next to Water: " + feature.properties.UrbanContiguoustoWaterinWS2011 + "<br>" +
            "Count of Mines: " + feature.properties.CountAllMininginWS, +"<br>" + "Number of Dams: " + feature
            .properties.CountofDamsinWS, {
              className: 'feature-tooltip',
              permanent: false,
              direction: 'right'
            });
        }
      });
      var case_study_legend_8 = '<p><b>Watershed Stressor Index</b></p>' +
        '<i style="background: #ffffb2; opacity: 0.5"></i><p><b>.04 - .09 </b></p>' +
        '<i style="background: #fecc5c; opacity: 0.5"></i><p><b>.1 - .14</b></p>' +
        '<i style="background: #fd8d3c; opacity: 0.5"></i><p><b>.15 - .2</b></p>' +
        '<i style="background: #f03b20; opacity: 0.5"></i><p><b>.21 - .29</b></p>' +
        '<i style="background: #bd0026; opacity: 0.5"></i><p><b>.3 - .5</b></p>';

      /// Scene Nine///
      // style choropleth case study map
      function setColor9(Social) {
        // Tenary operation: condition ? valueIfTrue : valueIfFalse
        return Social > .438 ? '#810f7c' :
          Social > .331 ? '#8856a7' :
          Social > .249 ? '#8c96c6' :
          Social > .192 ? '#b3cde3' :
          '#edf8fb';
      }
      // Set style function that sets fill color property
      function style9(feature) {
        return {
          fillColor: setColor9(feature.properties.Social),
          fillOpacity: 0.5,
          weight: .5,
          opacity: 0.8,
          color: '#ffffff',
        };
      }
      var case_study_9 = L.geoJson(casestudydata, {
        style: style9,
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.SUBWTRSHED + "<br>" + "Social Index: " + feature.properties
            .Social + "<br>" + "GAP Protection: " + feature.properties.GAPStatus123, {
              className: 'feature-tooltip',
              permanent: false,
              direction: 'right'
            });
        }
      });
      var case_study_legend_9 = '<p><b>Watershed Social Index</b></p>' +
        '<i style="background: #edf8fb; opacity: 0.5"></i><p><b>.167 - .191</b></p>' +
        '<i style="background: #b3cde3; opacity: 0.5"></i><p><b>.192 - .248</b></p>' +
        '<i style="background: #8c96c6; opacity: 0.5"></i><p><b>.249 - .330</b></p>' +
        '<i style="background: #b3cde3; opacity: 0.5"></i><p><b>.331 - .437</b></p>' +
        '<i style="background: #edf8fb; opacity: 0.5"></i><p><b>.438 - .500</b></p>';

      /// Scene Ten ///
      var national_legend = '<i style="background: black; opacity: 0.5"></i><p><b>HUC2</b></p>';
      var national = L.geoJson(nationalwatershedsdata, {
        style: function (feature) {
          return {
            color: '#dddddd',
            weight: .75,
            fillOpacity: .25,
            fillColor: '#2888ce'
          };
        },
        onEachFeature: function (feature, layer) {
          layer.bindTooltip(feature.properties.NAME + "<br>" + "HUC2: " +
            feature.properties.HUC2, {
              sticky: true,
              className: "feature-tooltip"
            });
          layer.on('mouseover', function () {
            layer.setStyle({
              weight: 2,
              fillOpacity: .7
            })
            layer.on('mouseout', function () {
              layer.setStyle({
                weight: 1,
                fillOpacity: .25
              })
            })
          })
        }
      });

      /// End of Scenes ///

      var darkLayer = L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png');

      var layers = {
        national: {
          layer: national,
          legend: national_legend
        },
        huc2: {
          layer: huc2,
          legend: huc2_legend
        },
        huc4: {
          layer: huc4,
          legend: huc4_legend
        },
        huc8: {
          layer: huc8,
          legend: huc8_legend
        },
        epa_choropleth: {
          layer: epa_choropleth,
          legend: epa_choropleth_legend
        },
        usbr: {
          layer: usbr,
          legend: usbr_legend
        },
        case_study_6: {
          layer: case_study_6,
          legend: case_study_6_legend
        },
        hydro: {
          layer: hydro,
          legend: hydro_legend
        },
        hydro2: {
          layer: hydro2,
          legend: hydro2_legend
        },
        case_study_7: {
          layer: case_study_7,
          legend: case_study_legend_7
        },
        case_study_8: {
          layer: case_study_8,
          legend: case_study_legend_8
        },
        case_study_9: {
          layer: case_study_9,
          legend: case_study_legend_9
        }
      }

      var scenes = {
        scene1: {
          lat: 39.5,
          lng: -105.35,
          zoom: 4.5,
          layers: [layers.national],
          name: "scene 1"
        },
        scene2: {
          lat: 44,
          lng: -119,
          zoom: 5.25,
          layers: [layers.huc2, layers.huc4],
          name: "scene 2"
        },
        scene3: {
          lat: 44.5701158,
          lng: -119,
          zoom: 5.25,
          layers: [layers.huc8],
          name: "scene 3"
        },
        scene4: {
          lat: 44,
          lng: -119,
          zoom: 5.25,
          layers: [layers.epa_choropleth],
          name: "scene 4"
        },
        scene5: {
          lat: 44.5701158,
          lng: -119,
          zoom: 5.25,
          layers: [layers.epa_choropleth, layers.usbr],
          name: "scene 5"
        },
        scene6: {
          lat: 38.6097,
          lng: -122.254,
          zoom: 9,
          layers: [layers.case_study_6, layers.hydro, layers.hydro2],
          name: "scene 6"
        },
        scene7: {
          lat: 38.6097,
          lng: -122.254,
          zoom: 9,
          layers: [layers.case_study_7, layers.case_study_6, layers.hydro],
          name: "scene 7"
        },
        scene8: {
          lat: 38.6097,
          lng: -122.254,
          zoom: 9,
          layers: [layers.case_study_8, layers.case_study_6, layers.hydro],
          name: "scene 8"
        },
        scene9: {
          lat: 38.6097,
          lng: -122.254,
          zoom: 9,
          layers: [layers.case_study_9, layers.case_study_6, layers.hydro],
          name: "scene 9"
        },
        scene10: {
          lat: 39.5,
          lng: -98.35,
          zoom: 4.5,
          layers: [layers.national],
          name: "scene 10"
        }

      };

      $('#storymap').storymap({
        scenes: scenes,
        legend: true,
        loader: true,
        scalebar: true,
        scrolldown: false,
        progressline: true,
        navwidget: true,
        createMap: function () {
          var map = L.map($(".storymap-map")[0], {
            zoomControl: false,
            scrollWheelZoom: false
          });
          // add a base map
          L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png')
            .addTo(map);

          return map;
        }
      });

    } //end ready
  </script>
</body>

</html>